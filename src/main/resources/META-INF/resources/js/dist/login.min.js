!function(n,e){var o="#btnLogin",t="#btnJoinNext",i=!1;function s(){e("#dvJoinService").show(),e("#dvJoinForm").hide(),e("#dvJoinCheck").hide(),e("#dvJoinResult").hide()}function a(n){var o=!0;e("#dvLoginJoin .tos input[type=checkbox]").each(function(){if(!e(this).is(":checked"))return o=!1,!1}).promise().done(function(){n&&n(o)})}n.init=function(){e("#joinUserEmailV").on("change",function(){e("#fmJoin").bootstrapValidator("revalidateField","joinUserEmailA"),e(this).val()}),e("#joinUserPhoneL").on("keyup",function(){e("#fmJoin").bootstrapValidator("revalidateField","joinUserPhoneM")}),e("#fmJoin").bootstrapValidator({submitButtons:'button[type="submit"]',live:"enabled",trigger:null,message:"유효하지 않은 값입니다.",excluded:":disabled",fields:{joinUserId:{message:"유효하지 않은 아이디 값입니다.",validators:{notEmpty:{message:"아이디값을 입력하세요"},callback:{message:"아이디 중복체크를 하세요",callback:function(n,e){return!!i}}}},joinPw:{validators:{notEmpty:{message:"비밀번호를 입력하세요"}}},joinPwConfirm:{validators:{notEmpty:{message:"비밀번호를 입력하세요"},identical:{field:"joinPw",message:"비밀번호가 일치하지 않습니다."}}},joinUserName:{validators:{notEmpty:{message:"이름을 입력하세요"}}},joinUserEmailA:{validators:{notEmpty:{message:"email을 입력하세요"},regexp:{regexp:/[^@]*/g,message:"@문자는 입력하실 수 없습니다."},callback:{message:"email을 선택하세요",callback:function(n,o){return!!e("#joinUserEmailV").val()}}}},joinUserPhoneM:{message:"숫자를 입력해 주세요",validators:{notEmpty:{message:"숫자를 입력해 주세요"},digits:{message:"숫자만 입력해 주세요"},stringLength:{min:3,max:4,message:"3~4자리 숫자를 입력하세요"},callback:{message:"4자리 숫자를 입력해 주세요",callback:function(n,o){var t=e.trim(e("#joinUserPhoneL").val());return!(!t||!/[0-9]/g.test(t)||4!=t.length)}}}}}}).on("success.form.bv",function(n){n.preventDefault(),e("#dvJoinForm").hide(),e("#dvJoinCheck").show()})},e(document).on("click",o,function(){e("#id").val(),e("#pw").val();hotplace.ajax({url:"login",method:"POST",dataType:"text",data:e("#loginFm").serialize(),success:function(n,o,t){var i;if(e.parseJSON(n).success){var s=e("#"+hotplace.dom.getMenuBtn().USER_LOGIN);"IN"==(i=s).data("gubun")?(gubun="OUT",i.find("img").prop("src",hotplace.getContextUrl()+"resources/img/menu/menu_logout.png"),i.find("p.over img").prop("src",hotplace.getContextUrl()+"resources/img/menu/menu_logout_on.png")):(gubun="IN",i.find("img").prop("src",hotplace.getContextUrl()+"resources/img/menu/menu_login.png"),i.find("p.over img").prop("src",hotplace.getContextUrl()+"resources/img/menu/menu_login_on.png")),i.data("gubun",gubun),hotplace.dom.closeModal(),hotplace.minimaps.bindData(hotplace.maps.getMap(),3)}},error:function(n,e,o){}})}),e(document).on("click","#btnLogoutYes",function(){hotplace.dom.logout(function(){window.location.reload()})}),e(document).on("click","#btnLogoutNo",function(){hotplace.dom.closeModal()}),e(document).on("keydown","#pw",function(n){if(13==n.which){n.target.value;e(o).trigger("click")}}),e(document).on("click","#btnJoinIdCheck",function(){hotplace.ajax({url:"user/checkId?id="+e("#joinUserId").val(),method:"GET",loadEl:"#dvLoginJoin",success:function(n){n.success&&("300"==n.errCode||(i=!0,e("#fmJoin").bootstrapValidator("revalidateField","joinUserId")))}})}),e(document).on("click",t,function(){a(function(n){n&&(e("#dvJoinService").hide(),e("#dvJoinForm").show())})}),e(document).on("click","#dvLoginJoin .tos",function(n){"INPUT"==n.target.nodeName&&a(function(n){n?(e(t).prop("disabled",!1),e(t).removeClass("btn-next-dis"),e(t).addClass("btn-next")):(e(t).prop("disabled",!0),e(t).addClass("btn-next-dis"),e(t).removeClass("btn-next"))})}),e(document).on("click","#dvJoinBtnPrev",function(){e("#dvJoinService").show(),e("#dvJoinForm").hide()}),e(document).on("click","#dvJoinCheckBtnCancel",function(){s()}),n.test=function(){},e(document).on("click","#dvJoinCheckBtnSubmit",function(){var n={};n.id=e("#joinUserId").val(),n.userName=e("#joinUserName").val(),n.password=e("#joinPw").val(),n.phone=e("#joinUserPhoneF").val()+"-"+e("#joinUserPhoneM").val()+"-"+e("#joinUserPhoneL").val(),n.email=e("#joinUserEmailA").val()+"@"+e("#joinUserEmailV").val(),hotplace.ajax({url:"user/join",data:JSON.stringify(n),contentType:"application/json; charset=UTF-8",success:function(n,o,t){n.success?(e("#pJoinResultMsg").text("회원가입이 완료되었습니다."),e("#dvJoinResultBtn").html('<button class="btn-success">로그인 화면으로</button>'),e("#fmJoin")[0].reset()):e("#pJoinResultMsg").text("오류가 발생했습니다."),e("#dvJoinCheck").hide(),e("#dvJoinResult").show()}})}),e(document).on("click","#dvJoinResultBtn button",function(){e(this).hasClass("btn-success")&&(e("#btnTabLogin").trigger("click"),setTimeout(function(){s()},500))})}(hotplace.login=hotplace.login||{},jQuery);